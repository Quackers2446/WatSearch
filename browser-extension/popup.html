<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>WatSearch Data Collector</title>
        <style>
            body {
                width: 350px;
                min-height: 400px;
                margin: 0;
                padding: 0;
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    sans-serif;
                background: #f8f9fa;
            }

            .header {
                background: #d32f2f;
                color: white;
                padding: 16px;
                text-align: center;
            }

            .header h1 {
                margin: 0;
                font-size: 18px;
                font-weight: 600;
            }

            .content {
                padding: 16px;
            }

            .status {
                background: #e3f2fd;
                border: 1px solid #2196f3;
                border-radius: 8px;
                padding: 12px;
                margin-bottom: 16px;
            }

            .status.success {
                background: #e8f5e8;
                border-color: #4caf50;
            }

            .status.error {
                background: #ffebee;
                border-color: #f44336;
            }

            .button {
                width: 100%;
                padding: 12px;
                border: none;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s;
                margin-bottom: 8px;
            }

            .button.primary {
                background: #d32f2f;
                color: white;
            }

            .button.primary:hover {
                background: #b71c1c;
            }

            .button.secondary {
                background: #f5f5f5;
                color: #333;
                border: 1px solid #ddd;
            }

            .button.secondary:hover {
                background: #eeeeee;
            }

            .settings {
                margin-top: 16px;
                padding-top: 16px;
                border-top: 1px solid #eee;
            }

            .settings h3 {
                margin: 0 0 8px 0;
                font-size: 14px;
                color: #666;
            }

            .input-group {
                margin-bottom: 12px;
            }

            .input-group label {
                display: block;
                font-size: 12px;
                color: #666;
                margin-bottom: 4px;
            }

            .input-group input {
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 12px;
            }

            .site-info {
                background: #f5f5f5;
                border-radius: 8px;
                padding: 12px;
                margin-bottom: 16px;
            }

            .site-info h3 {
                margin: 0 0 8px 0;
                font-size: 14px;
                color: #333;
            }

            .site-info p {
                margin: 0;
                font-size: 12px;
                color: #666;
            }

            .loading {
                display: none;
                text-align: center;
                padding: 20px;
            }

            .spinner {
                border: 2px solid #f3f3f3;
                border-top: 2px solid #d32f2f;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                animation: spin 1s linear infinite;
                margin: 0 auto 8px;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>WatSearch Data Collector</h1>
        </div>

        <div class="content">
            <div id="status" class="status">
                <strong>Ready to collect data</strong><br />
                <small
                    >Navigate to LEARN, Quest, or Piazza to extract course
                    information</small
                >
            </div>

            <div id="siteInfo" class="site-info" style="display: none">
                <h3 id="currentSite">Current Site</h3>
                <p id="siteDescription">Site description</p>
            </div>

            <button
                id="extractBtn"
                class="button primary"
                style="display: none"
            >
                Extract Course Data
            </button>

            <button id="sendBtn" class="button secondary" style="display: none">
                Send to WatSearch
            </button>

            <div id="outlineSection" style="display: none; margin-top: 16px">
                <div
                    id="termSelection"
                    style="
                        margin-bottom: 12px;
                        padding: 12px;
                        background: #f5f5f5;
                        border-radius: 8px;
                    "
                >
                    <label
                        style="
                            display: block;
                            font-size: 12px;
                            font-weight: 600;
                            color: #333;
                            margin-bottom: 8px;
                        "
                    >
                        Select Terms to Process:
                    </label>
                    <div
                        id="termCheckboxes"
                        style="
                            display: flex;
                            flex-direction: column;
                            gap: 6px;
                            max-height: 120px;
                            overflow-y: auto;
                        "
                    >
                        <!-- Terms will be populated here -->
                    </div>
                </div>
                <button
                    id="downloadOutlinesBtn"
                    class="button primary"
                    style="background: #1976d2"
                >
                    Process Selected Course Outlines
                </button>
                <button
                    id="cancelProcessingBtn"
                    class="button secondary"
                    style="
                        background: #dc3545;
                        color: white;
                        display: none;
                        margin-top: 8px;
                    "
                >
                    Cancel Processing
                </button>
                <small
                    style="
                        display: block;
                        margin-top: 4px;
                        color: #666;
                        font-size: 11px;
                        text-align: center;
                    "
                >
                    (Must be on outline.uwaterloo.ca listings page)
                </small>
            </div>

            <div class="settings">
                <h3>Settings</h3>

                <div class="input-group">
                    <label for="watSearchUrl">WatSearch URL:</label>
                    <input
                        type="text"
                        id="watSearchUrl"
                        placeholder="http://localhost:3000"
                        value="http://localhost:3000"
                    />
                </div>

                <button id="testConnection" class="button secondary">
                    Test Connection
                </button>
            </div>

            <div id="loading" class="loading">
                <div class="spinner"></div>
                <div>Processing...</div>
            </div>
        </div>

        <script src="popup.js"></script>
    </body>
</html>
